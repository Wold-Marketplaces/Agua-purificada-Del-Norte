<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agua purificada Del Norte - Gestión de Ventas</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Icons -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- SheetJS for Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo">
                <img src="logo de aguas.jpg"
                    style="height: 60px; width: auto; object-fit: contain; border-radius: 8px;">
                <div style="display: flex; flex-direction: column; justify-content: center; line-height: 1.1;">
                    <span style="font-size: 0.85rem; font-weight: 600;">Agua purificada</span>
                    <span style="color: var(--accent); font-size: 0.75rem;">Del Norte</span>
                </div>
                <i class='bx bx-menu-alt-right' id="menu-close"
                    style="display: none; font-size: 1.5rem; cursor: pointer; margin-left: auto;"></i>
            </div>

            <ul class="nav-links">
                <li class="active">
                    <a href="#">
                        <i class='bx bxs-dashboard'></i>
                        <span>Panel</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bx-package'></i>
                        <span>Pedidos</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bx-calendar-check'></i>
                        <span>Entregas Programadas</span>
                    </a>
                </li>
                <li class="has-submenu" id="ventas-menu-item">
                    <a href="#" class="submenu-toggle">
                        <div class="link-content">
                            <i class='bx bxs-cart-add'></i>
                            <span>Ventas</span>
                        </div>
                        <i class='bx bx-chevron-down' style="margin-left: auto;"></i>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#" data-view="Venta normal">
                                <i class='bx bx-radio-circle' style="color: #3b82f6;"></i>
                                <span>Venta Domicilio</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" data-view="Venta Comercial">
                                <i class='bx bx-radio-circle' style="color: #10b981;"></i>
                                <span>Venta Comercial</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" data-view="Suscripción Semanal">
                                <i class='bx bx-radio-circle' style="color: #f59e0b;"></i>
                                <span>Suscripción Semanal</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" data-view="Suscripción Quincenal">
                                <i class='bx bx-radio-circle' style="color: #8b5cf6;"></i>
                                <span>Suscripción Quincenal</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bx-water'></i>
                        <span>Producción</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bxs-package'></i>
                        <span>Inventario</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bxs-user-detail'></i>
                        <span>Clientes</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bxs-id-card'></i>
                        <span>Empleados</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bxs-report'></i>
                        <span>Reportes</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bx-wallet'></i>
                        <span>Caja</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <i class='bx bxs-cog'></i>
                        <span>Respaldo</span>
                    </a>
                </li>
            </ul>

            <div class="user-profile">
                <img src="https://ui-avatars.com/api/?name=Admin+User&background=3b82f6&color=fff" alt="Admin">
                <div class="user-info">
                    <h4>Administrador</h4>
                    <p>Gerente</p>
                </div>
                <i class='bx bx-log-out' id="logout-btn"></i>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div id="sidebar-overlay"
                style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 99; backdrop-filter: blur(4px);">
            </div>

            <!-- Dashboard View -->
            <section id="dashboard-view">
                <!-- Header -->
                <header>
                    <div class="mobile-menu-toggle" id="menu-open">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Panel de Agua purificada Del Norte</h1>
                            <p>Gestión de Ventas y Entregas</p>
                        </div>
                    </div>
                    <div class="search-box">
                        <i class='bx bx-search'></i>
                        <input type="text" id="dashboard-search" placeholder="Buscar agua, cliente o pedido...">
                    </div>
                    <div class="header-actions">
                        <button class="icon-btn" id="bell-stock" title="Stock Crítico"><i class='bx bxs-bell'
                                style="color: var(--warning);"></i><span class="badge" id="badge-stock"
                                style="background: var(--warning);">0</span></button>
                        <button class="icon-btn" id="bell-repairs" title="Pedidos Pendientes"><i class='bx bxs-bell'
                                style="color: var(--primary);"></i><span class="badge" id="badge-repairs"
                                style="background: var(--primary);">0</span></button>
                        <button class="icon-btn" id="bell-turnos" title="Entregas de Hoy"><i class='bx bxs-bell'
                                style="color: var(--success);"></i><span class="badge" id="badge-turnos"
                                style="background: var(--success);">0</span></button>
                        <button class="primary-btn" id="quick-sale-btn"><i class='bx bx-plus'></i> Venta Rápida</button>
                    </div>
                </header>

                <!-- Hero Banner -->
                <div class="hero-banner">
                    <div class="hero-overlay">
                        <div class="banner-text">
                            <h2>Panel de Control</h2>
                            <p>Gestión de Agua Purificada e Inventario</p>
                        </div>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon revenue">
                            <i class='bx bx-dollar-circle'></i>
                        </div>
                        <div class="stat-details">
                            <h3>Ventas de Hoy</h3>
                            <h2 id="stat-sales">$0</h2>
                            <span class="trend up"><i class='bx bx-up-arrow-alt'></i> +12%</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orders">
                            <i class='bx bx-shopping-bag'></i>
                        </div>
                        <div class="stat-details">
                            <h3>Pedidos</h3>
                            <h2 id="stat-orders">0</h2>
                            <span class="trend up"><i class='bx bx-up-arrow-alt'></i> +5%</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon products">
                            <i class='bx bxs-car-battery'></i>
                        </div>
                        <div class="stat-details">
                            <h3>Stock Crítico</h3>
                            <h2 id="stat-low-stock">0</h2>
                            <span class="trend down"><i class='bx bx-error-circle'></i> Alerta</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon customers">
                            <i class='bx bxs-group'></i>
                        </div>
                        <div class="stat-details">
                            <h3>Total Productos</h3>
                            <h2 id="stat-total-products">0</h2>
                            <span class="trend up"><i class='bx bx-smile'></i> Activos</span>
                        </div>
                    </div>
                </div>

                <!-- Recent Sales & Popular Products -->
                <div class="content-grid">
                    <div class="card recent-transactions">
                        <div class="card-header">
                            <h3>Pedidos / Entregas Recientes</h3>
                            <a href="#" class="view-all">Ver todas</a>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Cliente</th>
                                    <th>Artículos</th>
                                    <th>Total</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody id="recent-sales-table">
                                <!-- Dynamic content -->
                                <tr>
                                    <td colspan="5"
                                        style="text-align: center; padding: 2rem; color: var(--text-muted);">No hay
                                        ventas registradas hoy</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="card top-products">
                        <div class="card-header">
                            <h3>Más Vendidos</h3>
                        </div>
                        <div class="product-list" id="popular-products-list">
                            <div style="text-align: center; color: var(--text-muted); padding: 1rem;">Sin datos de
                                ventas</div>
                        </div>
                        <button class="secondary-btn full-width" id="go-to-inventory">Gestionar Inventario</button>
                    </div>
                </div>
            </section>

            <!-- Repairs View -->
            <section id="repairs-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-repairs">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Gestión de Pedidos</h1>
                            <p>Controla los pedidos y entregas de agua purificada.</p>
                        </div>
                    </div>
                    <div class="search-box">
                        <i class='bx bx-search'></i>
                        <input type="text" id="repairs-search" placeholder="Buscar cliente o pedido...">
                    </div>
                    <div class="header-actions">
                        <button class="primary-btn" id="new-repair-btn"><i class='bx bx-plus'></i> Nuevo
                            Pedido</button>
                    </div>
                </header>

                <!-- Repairs List -->
                <div class="card">
                    <div class="card-header">
                        <h3>Pedidos Activos</h3>
                    </div>
                    <div id="repair-list" class="repairs-list">
                        <!-- Dynamic repair items will be inserted here -->
                    </div>
                </div>
            </section>

            <section id="turnos-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-turnos">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Entregas Programadas</h1>
                            <p>Agenda y seguimiento de entregas programadas.</p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="primary-btn" id="new-turno-btn"><i class='bx bx-plus'></i> Nueva Entrega</button>
                    </div>
                </header>

                <div class="card" style="margin-bottom: 1.5rem;">
                    <div class="card-header"
                        style="display:flex; align-items:center; justify-content:space-between; gap: 1rem; flex-wrap:wrap;">
                        <h3>Calendario</h3>
                        <div style="display:flex; align-items:center; gap: 10px;">
                            <label for="turnos-date" style="color: var(--text-muted); font-size: 0.9rem;">Día</label>
                            <input type="date" id="turnos-date"
                                style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);">
                        </div>
                    </div>
                    <div id="turnos-day-summary" style="padding: 0 1.5rem 1.5rem; color: var(--text-muted);"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Entregas del Día</h3>
                    </div>
                    <div id="turnos-list" class="repairs-list"></div>
                </div>
            </section>

            <section id="turno-detail-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-turno-detail">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Detalle de Pedido</h1>
                        </div>
                    </div>
                    <button class="secondary-btn" onclick="switchTurnoView('Turnos')" style="margin-left: auto;">
                        <i class='bx bx-arrow-back'></i> Volver
                    </button>
                </header>

                <div class="card detail-card" style="max-width: 650px; margin: 2rem auto;">
                    <div class="detail-header">
                        <h2 id="turno-detail-title">Turno</h2>
                        <span id="turno-detail-badge" class="badge">Estado</span>
                    </div>
                    <p id="turno-detail-client" class="text-muted">Cliente</p>

                    <div style="margin-top: 1rem; display:grid; gap: 10px;">
                        <div style="display:flex; gap: 10px; flex-wrap:wrap;">
                            <div style="flex:1; min-width: 200px;">
                                <label style="color: var(--text-muted); font-size: 0.9rem;">Fecha</label>
                                <input type="date" id="turno-detail-date"
                                    style="width: 100%; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);">
                            </div>
                            <div style="flex:1; min-width: 200px;">
                                <label style="color: var(--text-muted); font-size: 0.9rem;">Hora</label>
                                <input type="time" id="turno-detail-time"
                                    style="width: 100%; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);">
                            </div>
                        </div>

                        <div>
                            <label style="color: var(--text-muted); font-size: 0.9rem;">Trabajo / Servicio</label>
                            <input type="text" id="turno-detail-service"
                                style="width: 100%; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);">
                        </div>

                        <div>
                            <label style="color: var(--text-muted); font-size: 0.9rem;">Notas</label>
                            <textarea id="turno-detail-notes" rows="3"
                                style="width: 100%; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);"></textarea>
                        </div>

                        <button onclick="saveTurnoDetail()" class="primary-btn"
                            style="width: 100%; height: auto; padding: 12px;">
                            <i class='bx bx-save'></i> Guardar Cambios
                        </button>
                    </div>

                    <div class="share-section"
                        style="border-top: 1px solid var(--border-glass); padding-top: 1.5rem; margin-top: 1.5rem;">
                        <p style="margin-bottom: 1rem;">Opciones para el Cliente:</p>
                        <div class="link-box" style="display: flex; gap: 10px; margin-bottom: 1rem; flex-wrap:wrap;">
                            <input type="text" id="turno-share-link" readonly
                                style="flex: 1; min-width: 220px; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-muted); font-size: 0.8rem;">
                            <button onclick="copyTurnoLink()" class="secondary-btn" title="Copiar Link"
                                style="width: auto;">
                                <i class='bx bx-copy'></i> Copiar
                            </button>
                            <button onclick="sendTurnoWhatsApp()"
                                style="background: #25D366; color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                                <i class='bx bxl-whatsapp'></i> WhatsApp
                            </button>
                        </div>
                        <button onclick="downloadTurnoStatusImage()" class="primary-btn"
                            style="width: 100%; margin-bottom: 1rem;">
                            <i class='bx bx-image'></i> DESCARGAR FOTO PARA WHATSAPP
                        </button>
                    </div>

                    <button onclick="deleteTurnoRecord()" class="action-btn delete"
                        style="width: 100%; margin-top: 1rem; padding: 12px; height: auto;">
                        <i class='bx bx-trash'></i> ELIMINAR REGISTRO
                    </button>
                </div>
            </section>

            <section id="new-turno-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-new-turno">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Nueva Entrega Programada</h1>
                            <p>Registra una entrega programada.</p>
                        </div>
                    </div>
                    <button class="secondary-btn" onclick="switchTurnoView('Turnos')" style="margin-left: auto;">
                        <i class='bx bx-arrow-back'></i> Volver
                    </button>
                </header>

                <div class="card" style="max-width: 650px; margin: 2rem auto;">
                    <form id="new-turno-form">
                        <div style="margin-bottom: 1.5rem;">
                            <h3><i class='bx bx-user'></i> Datos del Cliente</h3>
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Nombre</label>
                                <input type="text" id="turnoClientName" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>WhatsApp</label>
                                <input type="tel" id="turnoClientPhone" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <h3><i class='bx bx-calendar'></i> Turno</h3>
                            <div style="display:flex; gap: 10px; flex-wrap:wrap; margin-bottom: 1rem;">
                                <div style="flex:1; min-width: 200px;" class="form-group">
                                    <label>Fecha</label>
                                    <input type="date" id="turnoDate" required
                                        style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                                </div>
                                <div style="flex:1; min-width: 200px;" class="form-group">
                                    <label>Hora</label>
                                    <input type="time" id="turnoTime"
                                        style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                                </div>
                            </div>
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Producto / Servicio</label>
                                <input type="text" id="turnoService" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>Notas</label>
                                <textarea id="turnoNotes" rows="3"
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;"></textarea>
                            </div>
                        </div>

                        <button type="submit" class="primary-btn" style="width: 100%; padding: 12px; height: auto;">
                            <i class='bx bx-check'></i> Registrar Entrega
                        </button>
                    </form>
                </div>
            </section>

            <!-- Repair Detail View -->
            <section id="repair-detail-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-repair-detail">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Detalle de Pedido</h1>
                        </div>
                    </div>
                    <button class="secondary-btn" onclick="switchRepairView('Reparaciones')" style="margin-left: auto;">
                        <i class='bx bx-arrow-back'></i> Volver
                    </button>
                </header>

                <div class="card detail-card" style="max-width: 600px; margin: 2rem auto;">
                    <div class="detail-header">
                        <h2 id="detail-device">Equipo</h2>
                        <span id="detail-status" class="badge">Estado</span>
                    </div>
                    <p id="detail-client" class="text-muted">Cliente</p>

                    <div class="actions" style="margin-top: 1.5rem;">
                        <label style="color: var(--text-muted); font-size: 0.9rem;">Presupuesto / Costo ($)</label>
                        <div style="display: flex; gap: 10px; margin-bottom: 1.5rem;">
                            <input type="number" id="detail-cost-input"
                                style="flex-grow: 1; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);"
                                placeholder="0.00">
                            <button onclick="updateRepairPrice()" class="primary-btn"
                                style="padding: 0 1rem; width: auto; font-size: 0.9rem;">Guardar Precio</button>
                        </div>

                        <h3>Actualizar Estado</h3>
                        <div class="status-buttons"
                            style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 1.5rem;">
                            <button onclick="updateRepairStatus('pending')" class="status-btn">En Espera</button>
                            <button onclick="updateRepairStatus('working')" class="status-btn">En Taller</button>
                            <button onclick="updateRepairStatus('waiting_parts')" class="status-btn">Repuestos</button>
                            <button onclick="updateRepairStatus('ready')" class="status-btn">¡LISTO!</button>
                            <button onclick="updateRepairStatus('delivered')" class="status-btn">Entregado</button>
                        </div>
                    </div>

                    <div class="share-section" style="border-top: 1px solid var(--border-glass); padding-top: 1.5rem;">
                        <p style="margin-bottom: 1rem;">Opciones para el Cliente:</p>
                        <div class="link-box" style="display: flex; gap: 10px; margin-bottom: 1rem;">
                            <input type="text" id="share-link" readonly
                                style="flex: 1; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-muted); font-size: 0.8rem;">
                            <button onclick="copyRepairLink()" class="secondary-btn" title="Copiar Link"
                                style="width: auto;">
                                <i class='bx bx-copy'></i> Copiar
                            </button>
                            <button onclick="sendRepairWhatsApp()"
                                style="background: #25D366; color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                                <i class='bx bxl-whatsapp'></i> WhatsApp
                            </button>
                        </div>
                        <button onclick="downloadRepairStatusImage()" class="primary-btn"
                            style="width: 100%; margin-bottom: 1rem;">
                            <i class='bx bx-image'></i> DESCARGAR FOTO PARA WHATSAPP
                        </button>
                    </div>

                    <button onclick="deleteRepairRecord()" class="action-btn delete"
                        style="width: 100%; margin-top: 1rem; padding: 12px; height: auto;">
                        <i class='bx bx-trash'></i> ELIMINAR REGISTRO
                    </button>
                </div>
            </section>

            <!-- New Repair Form View -->
            <section id="new-repair-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-new-repair">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Nuevo Pedido</h1>
                            <p>Registra un nuevo pedido de cliente.</p>
                        </div>
                    </div>
                    <button class="secondary-btn" onclick="switchRepairView('Reparaciones')" style="margin-left: auto;">
                        <i class='bx bx-arrow-back'></i> Volver
                    </button>
                </header>

                <div class="card" style="max-width: 600px; margin: 2rem auto;">
                    <form id="new-repair-form">
                        <div style="margin-bottom: 1.5rem;">
                            <h3><i class='bx bx-user'></i> Datos del Cliente</h3>
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Nombre</label>
                                <input type="text" id="clientName" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>WhatsApp</label>
                                <input type="tel" id="clientPhone" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <h3><i class='bx bx-device-mobile'></i> Equipo</h3>
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Producto / Descripción</label>
                                <input type="text" id="deviceModel" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                            <div class="form-group">
                                <label>Monto ($)</label>
                                <input type="number" id="estimatedCost"
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                        </div>

                        <button type="submit" class="primary-btn" style="width: 100%; padding: 12px; height: auto;">
                            <i class='bx bx-check'></i> Registrar Pedido
                        </button>
                    </form>
                </div>
            </section>

            <section id="employees-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-employees">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Gestión de Empleados</h1>
                            <p>Configura comisiones por venta para cada empleado.</p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="primary-btn" id="add-employee-btn"><i class='bx bx-user-plus'></i> Nuevo
                            Empleado</button>
                    </div>
                </header>

                <div class="card">
                    <div class="card-header">
                        <h3>Lista de Empleados</h3>
                    </div>
                    <div class="table-container">
                        <table id="employees-table">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Comisión</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Dynamic Employees Rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="inventory-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-inv">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Gestión de Inventario</h1>
                            <p>Administra tus productos de agua y hielo.</p>
                        </div>
                    </div>
                    <div class="search-box">
                        <i class='bx bx-search'></i>
                        <input type="text" id="inventory-search" placeholder="Filtrar por nombre, código o marca...">
                    </div>
                    <div class="header-actions">
                        <button class="primary-btn" id="add-product-btn"><i class='bx bx-plus'></i> Nuevo
                            Producto</button>
                    </div>
                </header>

                <div class="card">
                    <div class="card-header">
                        <h3>Lista de Productos</h3>
                        <div class="table-filters">
                            <select id="filter-category" class="styled-select">
                                <option value="all">Todas las categorías</option>
                                <option value="Agua">Agua</option>
                                <option value="Hielo">Hielo</option>
                                <option value="Accesorios">Accesorios</option>
                                <option value="Servicios">Servicios</option>
                            </select>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="inventory-table">
                            <thead>
                                <tr>
                                    <th>Código</th>
                                    <th>Producto</th>
                                    <th>Marca</th>
                                    <th>Categoría</th>
                                    <th>Precio</th>
                                    <th>Stock</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Dynamic Inventory Rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Sale View -->
            <section id="sale-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-sale">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Nueva Venta</h1>
                            <p>Busca productos y genera el ticket de venta.</p>
                        </div>
                    </div>
                </header>

                <div class="content-grid pos-grid">
                    <!-- Product Selection -->
                    <div class="card product-selection">
                        <!-- Manual Entry Block -->
                        <div class="manual-add-block"
                            style="background: var(--bg-body); padding: 1rem; border-radius: 12px; border: 1px dashed var(--border-glass); margin-bottom: 1.5rem;">
                            <h4 id="manual-entry-title"
                                style="margin-bottom: 0.75rem; font-size: 0.9rem; color: var(--accent);"><i
                                    class='bx bx-edit'></i> Ingreso Manual / Fuera de Stock</h4>

                            <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 10px;">
                                <button type="button" class="quick-manual-btn"
                                    style="background: var(--bg-surface); border: 1px solid var(--border-glass); padding: 5px 12px; border-radius: 6px; cursor: pointer; color: var(--text-main); font-size: 0.8rem; transition: background 0.2s;">Bidón
                                    12 lts</button>
                                <button type="button" class="quick-manual-btn"
                                    style="background: var(--bg-surface); border: 1px solid var(--border-glass); padding: 5px 12px; border-radius: 6px; cursor: pointer; color: var(--text-main); font-size: 0.8rem; transition: background 0.2s;">Bidón
                                    20 lts</button>
                                <button type="button" class="quick-manual-btn"
                                    style="background: var(--bg-surface); border: 1px solid var(--border-glass); padding: 5px 12px; border-radius: 6px; cursor: pointer; color: var(--text-main); font-size: 0.8rem; transition: background 0.2s;">Hielo
                                    2kg</button>
                                <button type="button" class="quick-manual-btn"
                                    style="background: var(--bg-surface); border: 1px solid var(--border-glass); padding: 5px 12px; border-radius: 6px; cursor: pointer; color: var(--text-main); font-size: 0.8rem; transition: background 0.2s;">Hielo
                                    10kg</button>
                                <button type="button" class="quick-manual-btn"
                                    style="background: var(--bg-surface); border: 1px solid var(--border-glass); padding: 5px 12px; border-radius: 6px; cursor: pointer; color: var(--text-main); font-size: 0.8rem; transition: background 0.2s;">Bolsón
                                    x 4</button>
                                <button type="button" class="quick-manual-btn"
                                    style="background: var(--bg-surface); border: 1px solid var(--border-glass); padding: 5px 12px; border-radius: 6px; cursor: pointer; color: var(--text-main); font-size: 0.8rem; transition: background 0.2s;">Nido
                                    Nueva Producción</button>
                            </div>

                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <input type="text" id="manual-desc" placeholder="Descripción (ej: Envío extra)"
                                    style="flex: 2; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);">
                                <input type="number" id="manual-price" placeholder="$ Precio"
                                    style="flex: 1; padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);">
                                <button id="add-manual-btn" class="secondary-btn" title="Agregar Manual"
                                    style="padding: 0 1rem;">
                                    <i class='bx bx-plus'></i>
                                </button>
                            </div>
                        </div>

                        <div class="search-box full-width" style="margin-bottom: 1.5rem;">
                            <i class='bx bx-search'></i>
                            <input type="text" id="pos-search" placeholder="Escribe nombre o código del producto...">
                        </div>
                        <div class="pos-products-grid" id="pos-products-list">
                            <!-- Dynamic Products for Sale -->
                        </div>
                    </div>

                    <!-- Cart / Summary -->
                    <div class="card cart-summary">
                        <div class="card-header">
                            <h3>Carrito de Compra</h3>
                            <button class="icon-btn" id="clear-cart" title="Vaciar Carrito"><i
                                    class='bx bx-trash'></i></button>
                        </div>
                        <div class="cart-items" id="cart-items-list">
                            <!-- Dynamic Cart Items -->
                        </div>

                        <div class="cart-totals">
                            <div class="total-row">
                                <span>Subtotal</span>
                                <span id="cart-subtotal">$0</span>
                            </div>
                            <div class="total-row main-total">
                                <span>Total</span>
                                <span id="cart-total">$0</span>
                            </div>
                        </div>

                        <div class="client-selection-pos" style="margin-bottom: 1.5rem;">
                            <label
                                style="display: block; font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.75rem;">Cliente</label>
                            <select id="pos-client-select" class="styled-select full-width"
                                style="margin-bottom: 10px;">
                                <option value="Consumidor Final">Consumidor Final</option>
                                <!-- Dynamic Clients here -->
                            </select>
                            <label
                                style="display: block; font-size: 0.85rem; color: var(--text-muted); margin: 10px 0 0.75rem;">Empleado
                                / Vendedor</label>
                            <select id="pos-employee-select" class="styled-select full-width"
                                style="margin-bottom: 10px;">
                                <option value="">Sin asignar</option>
                                <!-- Dynamic Employees here -->
                            </select>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="pos-sub-client" class="styled-select"
                                    placeholder="Nombre del cliente (Opcional)"
                                    style="font-size: 0.85rem; padding: 10px; flex: 1;">
                                <input type="text" id="pos-vehicle-plate" class="styled-select"
                                    placeholder="Patente / Vehículo"
                                    style="font-size: 0.85rem; padding: 10px; width: 140px;">
                            </div>
                        </div>

                        <div class="payment-methods">
                            <label>Método de Pago</label>
                            <div class="method-options">
                                <button class="method-btn active" data-method="Efectivo"><i class='bx bx-money'></i>
                                    Efectivo</button>
                                <button class="method-btn" data-method="Tarjeta"><i class='bx bx-credit-card'></i>
                                    Tarjeta</button>
                                <button class="method-btn" data-method="Transferencia"><i class='bx bx-transfer'></i>
                                    Transf.</button>
                                <button class="method-btn" data-method="A Cuenta"><i class='bx bx-time-five'></i> A
                                    Cuenta</button>
                            </div>
                        </div>

                        <button class="primary-btn full-width checkout-btn" id="finalize-sale">
                            <i class='bx bx-check-circle'></i> Finalizar Venta
                        </button>
                    </div>
                </div>
            </section>

            <!-- Clients View -->
            <section id="clients-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-clients">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Gestión de Clientes</h1>
                            <p>Administra tu base de datos de clientes.</p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="primary-btn" id="add-client-btn"><i class='bx bx-user-plus'></i> Nuevo
                            Cliente</button>
                    </div>
                </header>

                <div class="card">
                    <div class="card-header">
                        <h3>Cartera de Clientes</h3>
                    </div>
                    <div class="table-container">
                        <table id="clients-table">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Dirección</th>
                                    <th>Teléfono</th>
                                    <th>Tipo de Cliente</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Dynamic Clients Rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Reports View -->
            <section id="reports-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-reports">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Reportes y Estadísticas</h1>
                            <p>Analiza el rendimiento de tu negocio.</p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="primary-btn" id="daily-report-btn" title="Reporte Diario"><i
                                class='bx bxs-pie-chart-alt-2'></i> Reporte Diario</button>
                        <button class="secondary-btn" id="export-json" title="Exportar JSON"><i
                                class='bx bxs-file-json'></i> JSON</button>
                        <button class="secondary-btn" id="export-excel" title="Exportar Excel"><i
                                class='bx bxs-file-export'></i> Excel</button>
                        <button class="primary-btn" id="import-btn" title="Cargar Datos"><i
                                class='bx bxs-cloud-upload'></i> Importar</button>
                        <input type="file" id="import-input" style="display: none;" accept=".json,.xlsx">
                    </div>
                </header>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon revenue">
                            <i class='bx bx-trending-up'></i>
                        </div>
                        <div class="stat-details">
                            <h3>Total Vendido</h3>
                            <h2 id="report-total-revenue">$0</h2>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon customers">
                            <i class='bx bx-user-check'></i>
                        </div>
                        <div class="stat-details">
                            <h3>Promedio por Venta</h3>
                            <h2 id="report-avg-sale">$0</h2>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Caja (Día)</h3>
                    </div>
                    <div class="stats-grid" style="padding: 0 0 1.5rem;">
                        <div class="stat-card">
                            <div class="stat-icon revenue"><i class='bx bx-log-in'></i></div>
                            <div class="stat-details">
                                <h3>Entradas</h3>
                                <h2 id="report-caja-in">$0</h2>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon orders"><i class='bx bx-log-out'></i></div>
                            <div class="stat-details">
                                <h3>Salidas</h3>
                                <h2 id="report-caja-out">$0</h2>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon customers"><i class='bx bx-calculator'></i></div>
                            <div class="stat-details">
                                <h3>Saldo</h3>
                                <h2 id="report-caja-balance">$0</h2>
                            </div>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Tipo</th>
                                    <th>Concepto</th>
                                    <th>Monto</th>
                                </tr>
                            </thead>
                            <tbody id="report-caja-table">
                                <tr>
                                    <td colspan="4" style="text-align: center; padding: 2rem; color: var(--text-muted);">No hay movimientos</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Historial de Ventas</h3>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Transacción</th>
                                    <th>Empleado</th>
                                    <th>Artículos</th>
                                    <th>Método</th>
                                    <th>Total</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="full-sales-history">
                                <!-- Dynamic Sales -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Ventas por Empleado</h3>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Empleado</th>
                                    <th>Ventas</th>
                                    <th>Total Vendido</th>
                                    <th>Comisión</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="employee-sales-summary">
                                <!-- Dynamic Employee Summary -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="caja-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-caja">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Caja</h1>
                            <p>Registro de entradas y salidas de caja.</p>
                        </div>
                    </div>
                </header>

                <div class="card" style="margin-bottom: 1.5rem;">
                    <div class="card-header" style="display:flex; align-items:center; justify-content:space-between; gap: 1rem; flex-wrap:wrap;">
                        <h3>Balance</h3>
                        <div style="display:flex; align-items:center; gap: 10px; flex-wrap: wrap;">
                            <label for="caja-date" style="color: var(--text-muted); font-size: 0.9rem;">Día</label>
                            <input type="date" id="caja-date"
                                style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);">
                            <label for="caja-month" style="color: var(--text-muted); font-size: 0.9rem;">Mes</label>
                            <input type="month" id="caja-month"
                                style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main);">
                        </div>
                    </div>

                    <div class="stats-grid" style="padding: 0 1.5rem 1.5rem;">
                        <div class="stat-card">
                            <div class="stat-icon revenue"><i class='bx bx-log-in'></i></div>
                            <div class="stat-details">
                                <h3>Entradas (Día)</h3>
                                <h2 id="caja-in-day">$0</h2>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon orders"><i class='bx bx-log-out'></i></div>
                            <div class="stat-details">
                                <h3>Salidas (Día)</h3>
                                <h2 id="caja-out-day">$0</h2>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon customers"><i class='bx bx-calculator'></i></div>
                            <div class="stat-details">
                                <h3>Saldo (Día)</h3>
                                <h2 id="caja-balance-day">$0</h2>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon products"><i class='bx bx-calendar'></i></div>
                            <div class="stat-details">
                                <h3>Saldo (Mes)</h3>
                                <h2 id="caja-balance-month">$0</h2>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card" style="max-width: 800px; margin: 0 auto 1.5rem;">
                    <div class="card-header">
                        <h3>Nuevo Movimiento</h3>
                    </div>
                    <form id="caja-form" style="padding: 1.5rem; display: grid; gap: 1rem;">
                        <div style="display:flex; gap: 10px; flex-wrap: wrap;">
                            <div style="flex:1; min-width: 200px;" class="form-group">
                                <label>Fecha</label>
                                <input type="date" id="caja-mov-date" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                            <div style="flex:1; min-width: 200px;" class="form-group">
                                <label>Tipo</label>
                                <select id="caja-mov-type" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                                    <option value="entrada">Entrada</option>
                                    <option value="salida">Salida</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Concepto</label>
                            <input type="text" id="caja-mov-concept" required placeholder="Ej: Pago de cuenta / Parche cubierta"
                                style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>Monto ($)</label>
                            <input type="number" id="caja-mov-amount" required step="0.01" placeholder="0.00"
                                style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                        </div>
                        <button type="submit" class="primary-btn" style="width: 100%; padding: 12px; height: auto;">
                            <i class='bx bx-save'></i> Guardar Movimiento
                        </button>
                    </form>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Movimientos</h3>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Tipo</th>
                                    <th>Concepto</th>
                                    <th>Monto</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="caja-table">
                                <tr>
                                    <td colspan="5" style="text-align: center; padding: 2rem; color: var(--text-muted);">No hay movimientos</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="settings-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-settings">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Configuración del Sistema</h1>
                            <p>Personaliza tu experiencia y gestiona tus datos.</p>
                        </div>
                    </div>
                </header>

                <div class="content-grid pos-grid" style="grid-template-columns: 1.5fr 1fr;">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class='bx bx-store-alt'></i> Perfil del Negocio</h3>
                        </div>
                        <form id="settings-form" class="form-grid" style="padding: 1.5rem; display: grid; gap: 1rem;">
                            <!-- 
                                Customization fields removed as per request. 
                                Only developer can customize store name/logo.
                            -->
                            <div class="form-group" style="opacity: 0.5; pointer-events: none;">
                                <label>Licencia del Software</label>
                                <input type="text" value="Licencia Estándar - RepuestosPOS" readonly>
                                <small style="color: var(--text-muted); display: block; margin-top: 5px;">
                                    La personalización de marca es exclusiva del administrador del sistema.
                                </small>
                            </div>
                            <button type="submit" class="primary-btn" style="margin-top: 1rem;">Guardar Cambios</button>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3><i class='bx bx-shield-quarter'></i> Mantenimiento</h3>
                        </div>
                        <div style="padding: 1.5rem; display: flex; flex-direction: column; gap: 1rem;">
                            <p style="font-size: 0.85rem; color: var(--text-muted);">
                                Estas acciones son irreversibles. Asegúrate de haber exportado tus datos primero.
                            </p>
                            <button class="action-btn delete" id="clear-db-btn"
                                style="width: 100%; padding: 12px; height: auto;">
                                <i class='bx bx-trash'></i> Borrar Toda la Base de Datos
                            </button>
                            <hr style="border: none; border-top: 1px solid var(--border-glass); margin: 5px 0;">
                            <div class="form-group">
                                <label>Porcentaje de IVA (%)</label>
                                <input type="number" id="set-tax-percent" value="21">
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Client View Section -->
            <section id="client-view" style="display: none;">
                <div class="detail-card"
                    style="text-align: center; max-width: 600px; margin: 3rem auto; padding: 3rem; background: var(--bg-surface); border-radius: 12px; border: 1px solid var(--border-glass);">
                    <i class='bx bxs-check-circle'
                        style="font-size: 3rem; color: var(--accent); margin-bottom: 1rem;"></i>
                    <h1 style="color: var(--accent); margin-bottom: 0.5rem;">Estado en Vivo</h1>
                    <p id="client-order-id" class="text-muted">Orden #...</p>
                    <h2 id="client-device-model" style="margin: 1rem 0; font-size: 1.8rem;">Cargando...</h2>
                    <p id="client-name-display" class="text-muted" style="margin-bottom: 2rem; font-size: 0.95rem;"></p>

                    <div id="client-progress"
                        style="text-align: left; max-width: 400px; margin: 2rem auto; background: var(--bg-color); padding: 1.5rem; border-radius: 1rem; border: 1px solid var(--border-glass);">
                    </div>

                    <div class="share-section"
                        style="border-top: 1px solid var(--border-glass); padding-top: 1.5rem; margin-top: 2rem;">
                        <p style="margin-bottom: 1rem; color: var(--text-muted);">Costo Estimado</p>
                        <h2 id="client-cost" style="color: var(--accent); font-size: 2.5rem; margin-top: 0.5rem;">$ -
                        </h2>
                    </div>
                </div>
            </section>

            <!-- Producción View -->
            <section id="produccion-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-produccion">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Gestión de Producción</h1>
                            <p>Registro de producción diaria de agua purificada.</p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="primary-btn" id="new-produccion-btn"><i class='bx bx-plus'></i> Nueva
                            Producción</button>
                    </div>
                </header>

                <!-- Registro de Producción -->
                <div class="card">
                    <div class="card-header">
                        <h3>Historial de Producción</h3>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Producto</th>
                                <th>Cantidad (L)</th>
                                <th>Empleado</th>
                                <th>Insumos Utilizados</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="produccion-table">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 2rem; color: var(--text-muted);">
                                    No hay registros de producción
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Nueva Producción Form -->
            <section id="new-produccion-view" style="display: none;">
                <header>
                    <div class="mobile-menu-toggle" id="menu-open-new-produccion">
                        <i class='bx bx-menu'></i>
                    </div>
                    <div class="header-title" style="display: flex; align-items: center; gap: 15px;">
                        <img src="logo de aguas.jpg"
                            style="height: 50px; width: auto; object-fit: contain; border-radius: 8px; filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.3));">
                        <div>
                            <h1>Nueva Producción</h1>
                            <p>Registra una nueva producción de agua purificada.</p>
                        </div>
                    </div>
                    <button class="secondary-btn" onclick="switchProduccionView('Produccion')"
                        style="margin-left: auto;">
                        <i class='bx bx-arrow-back'></i> Volver
                    </button>
                </header>

                <div class="card" style="max-width: 650px; margin: 2rem auto;">
                    <form id="new-produccion-form">
                        <div style="margin-bottom: 1.5rem;">
                            <h3><i class='bx bx-calendar'></i> Datos de Producción</h3>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Fecha</label>
                                <input type="date" id="produccionDate" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Tipo de Producto</label>
                                <select id="produccionProducto" required
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                                    <option value="">Selecciona un producto</option>
                                    <option value="Agua 5L">Agua Purificada 5L</option>
                                    <option value="Agua 10L">Agua Purificada 10L</option>
                                    <option value="Agua 20L">Agua Purificada 20L</option>
                                    <option value="Agua Garrafón">Agua Purificada Garrafón</option>
                                    <option value="Bidón 12L">Bidón x 12 litros</option>
                                    <option value="Bidón 20L">Bidón x 20 litros</option>
                                    <option value="Hielo 2kg">Hielo x 2 kilos</option>
                                    <option value="Hielo 10kg">Hielo x 10 kilos</option>
                                    <option value="Bolsón x 4">Bolsón x 4</option>
                                    <option value="Nido">Nido</option>
                                </select>
                            </div>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Cantidad Producida (Litros)</label>
                                <input type="number" id="produccionCantidad" required step="0.01" placeholder="0.00"
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Empleado Responsable</label>
                                <input type="text" id="produccionEmpleado" required placeholder="Nombre del empleado"
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <h3><i class='bx bx-package'></i> Insumos Utilizados</h3>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Filtros Utilizados</label>
                                <input type="number" id="produccionFiltros" step="0.01" placeholder="0"
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Químicos Purificadores (ml)</label>
                                <input type="number" id="produccionQuimicos" step="0.01" placeholder="0"
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>

                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label>Botellas/Envases Utilizados</label>
                                <input type="number" id="produccionEnvases" step="1" placeholder="0"
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;">
                            </div>

                            <div class="form-group">
                                <label>Notas Adicionales</label>
                                <textarea id="produccionNotas" rows="3"
                                    style="padding: 10px; background: var(--bg-surface); border: 1px solid var(--border-glass); border-radius: 8px; color: var(--text-main); width: 100%;"></textarea>
                            </div>
                        </div>

                        <button type="submit" class="primary-btn" style="width: 100%; padding: 12px; height: auto;">
                            <i class='bx bx-check'></i> Registrar Producción
                        </button>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal for Adding/Editing Product -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Añadir Nuevo Producto</h2>
                <i class='bx bx-x close-modal'></i>
            </div>
            <form id="product-form">
                <input type="hidden" id="edit-id">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="p-code">Código / SKU</label>
                        <input type="text" id="p-code" required placeholder="Ej: AGUA-20L">
                    </div>
                    <div class="form-group">
                        <label for="p-name">Nombre del Producto</label>
                        <input type="text" id="p-name" required placeholder="Ej: Bidón Agua 20L">
                    </div>
                    <div class="form-group">
                        <label for="p-brand">Marca</label>
                        <input type="text" id="p-brand" required placeholder="Ej: Agua purificada Del Norte">
                    </div>
                    <div class="form-group">
                        <label for="p-category">Categoría</label>
                        <select id="p-category" required>
                            <option value="Agua">Agua</option>
                            <option value="Hielo">Hielo</option>
                            <option value="Accesorios">Accesorios</option>
                            <option value="Servicios">Servicios</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="p-price">Precio de Venta ($)</label>
                        <input type="number" id="p-price" required step="0.01" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label for="p-stock">Stock Inicial</label>
                        <input type="number" id="p-stock" required placeholder="0">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="secondary-btn close-modal">Cancelar</button>
                    <button type="submit" class="primary-btn">Guardar Producto</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Adding/Editing Client -->
    <div id="client-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="client-modal-title">Añadir Nuevo Cliente</h2>
                <i class='bx bx-x close-client-modal'></i>
            </div>
            <form id="client-form">
                <input type="hidden" id="edit-client-id">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="c-name">Nombre</label>
                        <input type="text" id="c-name" required placeholder="Ej: Juan Pérez">
                    </div>
                    <div class="form-group">
                        <label for="c-address">Dirección</label>
                        <input type="text" id="c-address" required placeholder="Ej: Calle Gran Vía 123">
                    </div>
                    <div class="form-group">
                        <label for="c-phone">Teléfono</label>
                        <input type="text" id="c-phone" placeholder="+54 9 ...">
                    </div>
                    <div class="form-group">
                        <label for="c-type">Tipo de Cliente</label>
                        <input type="text" id="c-type" placeholder="Ej: Comercial / Residencial">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="secondary-btn close-client-modal">Cancelar</button>
                    <button type="submit" class="primary-btn">Guardar Cliente</button>
                </div>
            </form>
        </div>
    </div>

    <div id="employee-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="employee-modal-title">Añadir Nuevo Empleado</h2>
                <i class='bx bx-x close-employee-modal'></i>
            </div>
            <form id="employee-form">
                <input type="hidden" id="edit-employee-id">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="e-name">Nombre</label>
                        <input type="text" id="e-name" required placeholder="Ej: Juan / María">
                    </div>
                    <div class="form-group">
                        <label for="e-commission">Comisión (%)</label>
                        <input type="number" id="e-commission" required step="0.01" placeholder="0">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="secondary-btn close-employee-modal">Cancelar</button>
                    <button type="submit" class="primary-btn">Guardar Empleado</button>
                </div>
            </form>
        </div>
    </div>

    <div id="employee-sales-modal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 id="employee-sales-modal-title">Ventas del Empleado</h2>
                <i class='bx bx-x close-employee-sales-modal'></i>
            </div>
            <div class="table-container" style="padding: 1.5rem;">
                <table>
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Cliente</th>
                            <th>Artículos</th>
                            <th>Total</th>
                            <th>Comisión</th>
                        </tr>
                    </thead>
                    <tbody id="employee-sales-history">
                        <!-- Dynamic Employee Sales -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Daily Report Modal -->
    <div id="daily-report-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <div>
                    <h2>Reporte Diario de Ventas</h2>
                    <p id="daily-report-date" style="color: var(--text-muted); font-size: 0.9rem;"></p>
                </div>
                <i class='bx bx-x close-daily-modal' style="font-size: 1.75rem; cursor: pointer;"></i>
            </div>

            <div class="daily-stats-container" style="display: grid; gap: 1.5rem;">
                <div class="main-stat-card"
                    style="background: rgba(59, 130, 246, 0.1); border: 1px solid var(--primary); padding: 1.5rem; border-radius: 12px; text-align: center;">
                    <span style="color: var(--text-muted); display: block; margin-bottom: 5px;">Ventas Totales
                        Hoy</span>
                    <h2 id="daily-total-sales" style="font-size: 2.5rem; color: var(--primary);">$0</h2>
                    <span id="daily-sales-count-label" style="font-size: 0.9rem; color: var(--text-muted);"><span
                            id="daily-sales-count">0</span> transacciones</span>
                </div>

                <div class="methods-breakdown">
                    <h3 style="margin-bottom: 1rem; font-size: 1rem; font-weight: 600;">Caja (Día)</h3>
                    <div style="display: grid; gap: 10px;">
                        <div class="daily-method-item" style="display:flex; justify-content:space-between; align-items:center; padding: 10px; background: var(--bg-body); border: 1px solid var(--border-glass); border-radius: 10px;">
                            <span>Entradas</span>
                            <strong id="daily-caja-in">$0</strong>
                        </div>
                        <div class="daily-method-item" style="display:flex; justify-content:space-between; align-items:center; padding: 10px; background: var(--bg-body); border: 1px solid var(--border-glass); border-radius: 10px;">
                            <span>Salidas</span>
                            <strong id="daily-caja-out">$0</strong>
                        </div>
                    </div>
                </div>

                <div class="methods-breakdown">
                    <h3 style="margin-bottom: 1rem; font-size: 1rem; font-weight: 600;">Desglose por Medio de Pago</h3>
                    <div id="daily-methods-list" style="display: grid; gap: 10px;">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </div>

            <div class="modal-footer" style="margin-top: 2rem;">
                <button class="secondary-btn close-daily-modal">Cerrar</button>
                <button class="primary-btn" id="print-daily-report">
                    <i class='bx bx-printer'></i> Imprimir Reporte
                </button>
            </div>
        </div>
    </div>

    <!-- Success Sale Modal -->
    <div id="success-modal" class="modal">
        <div class="modal-content" style="text-align: center; max-width: 400px; padding: 3rem;">
            <i class='bx bxs-check-circle' style="font-size: 5rem; color: var(--success); margin-bottom: 1rem;"></i>
            <h2>¡Venta Registrada!</h2>
            <p style="color: var(--text-muted); margin-bottom: 2rem;">La venta se ha procesado con éxito y el stock ha
                sido actualizado.</p>
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button class="primary-btn full-width" id="print-ticket-success"
                    style="justify-content: center; height: 50px;">
                    <i class='bx bx-printer'></i> Imprimir Ticket
                </button>
                <button class="secondary-btn full-width" id="whatsapp-share-success"
                    style="justify-content: center; height: 50px; background-color: #25D366; color: white; border: none;">
                    <i class='bx bxl-whatsapp' style="font-size: 1.2rem; margin-right: 8px;"></i> Enviar por WhatsApp
                </button>
                <button class="secondary-btn full-width" id="close-success-modal" style="height: 50px;">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Ticket Print Area (Hidden in UI) -->
    <div id="ticket-print-area"></div>

    <script src="main.js"></script>
</body>

</html>